"use strict";(function(){angular.module("loc8rApp",["socialLogin","ui.bootstrap","ngRoute","ngSanitize"]);function e(e,t,o,r){o.defaults.useXDomain=true;delete o.defaults.headers.common["X-Requested-With"];r.setGoogleKey("206179895507-v4u0aprobcoh5cfarlva3m621ne96t5c.apps.googleusercontent.com");t.html5Mode(true);e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"common/views/genericText.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/location/:locationid",{templateUrl:"/locationDetail/locationDetail.view.html",controller:"locationDetailCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/forgot",{templateUrl:"/auth/forgotpassword/forgotpassword.view.html",controller:"forgotCtrl",controllerAs:"vm"}).when("/reset/:token",{templateUrl:"/auth/resetpassword/resetpassword.view.html",controller:"resetpasswordCtrl",controllerAs:"vm"}).when("/callback/:token",{templateUrl:"/home/home.view.html",controller:"loginCallbackCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"})}angular.module("loc8rApp").config(["$routeProvider","$locationProvider","$httpProvider","socialProvider",e])})();"use strict";(function(){angular.module("loc8rApp").controller("homeCtrl",e);e.$injector=["$scope","loc8rData","geolocation"];function e(e,t,o,r){var n=this;n.returnPage=r.search().page||"/";n.pageHeader={title:"Loc8r",strapline:"Find places to work with wifi near you!"};n.sidebar={content:"Looking for wifi and a seat etc etc"};n.message="Checking your location";n.getData=function(e){var o=e.coords.latitude,r=e.coords.longitude;n.message="searching for nearby places";t.locationByCoords(o,r).then(function(e){var t=e.data;n.message=t.length>0?"":"No locations found nearby";n.data={locations:t}},function(e){n.message="Sorry, something's gone wrong"})};n.showError=function(t){e.$apply(function(){n.message=t.message})};n.noGeo=function(){e.$apply(function(){n.message="Geolocation not supported by this browser."})};o.getPosition(n.getData,n.showError,n.noGeo)}})();"use strict";(function(){function e(e,t,o,r,n){var a=this;a.locationid=e.locationid;a.isLoggedIn=n.isLoggedIn();a.currentPath=o.path();r.locationById(a.locationid).then(function(e){var t=e.data;a.data={location:t};a.pageHeader={title:a.data.location.name}},function(e){console.log(e)});a.popupReviewForm=function(){var e=t.open({templateUrl:"/reviewModal/reviewModal.view.html",controller:"reviewModalCtrl as vm",size:"lg",resolve:{locationData:function(){return{locationid:a.locationid,locationName:a.data.location.name}}}});e.result.then(function(e){console.log("data iss",e);a.data.location.reviews.push(e)})}}e.$inject=["$routeParams","$uibModal","$location","loc8rData","authentication"];angular.module("loc8rApp").controller("locationDetailCtrl",e)})();"use strict";(function(){var e=function(){var e=this;e.pageHeader={title:"About Loc8r",strapline:"Find local!"};e.main={content:"Loc8r was created to help people find places to sit down and get a bit of work done.\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit lorem lorem Lorem ipsum dolor sit amet, consectetur adipisicing elit.\n\n Id odit repellendus veniam eius magnam, ipsa expedita excepturi laboriosam! Praesentium blanditiis ipsam minus. Sapiente debitis, nobis. Aspernatur in quia odit reprehenderit. Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore, neque? Vel, facere nostrum debitis autem odio in quaerat eaque labore. Sit nam soluta, vitae corporis, quam doloribus eligendi fugit earum.."}};angular.module("loc8rApp").controller("aboutCtrl",e)})();"use strict";(function(){function e(e,t,o){var r=this;r.locationData=o;r.onSubmit=function(){if(!r.formData.reviewText||!r.formData.rating){r.formError="All fields required, please  try  again!";return false}else{r.doAddReview(r.locationData.locationid,r.formData)}};r.doAddReview=function(e,o){t.addReviewById(e,{rating:o.rating,reviewText:o.reviewText}).then(function(e){e=e.data;console.log("Send data success!");r.modal.close(e)},function(e){r.formError=e.data.message})};r.modal={close:function(t){e.close(t)},cancel:function(){e.dismiss("cancel")}}}e.$inject=["$uibModalInstance","loc8rData","locationData"];angular.module("loc8rApp").controller("reviewModalCtrl",e)})();"use strict";(function(){var e=function(e,t){var o=this;o.pageHeader={title:"Create a new Loc8r account"};o.credentials={name:"",email:"",password:""};o.returnPage=e.search().page||"/";o.onSubmit=function(){var e=document.getElementById("txtPassword").value;var t=document.getElementById("txtConfirmPassword").value;o.formError="";if(!o.credentials.name||!o.credentials.email||!o.credentials.password){o.formError="All fields required, please try again!"}if(e!==t){o.formError="Passwords do not match.";return false}else{o.doRegister();return true}};o.doRegister=function(){o.formError="form Error";t.register(o.credentials).then(function(){e.search("page",null);e.path(o.returnPage)},function(e){o.formError=e.data.message})}};e.$injector=["$location","authentication"];angular.module("loc8rApp").controller("registerCtrl",e)})();"use strict";(function(){var e=function(e,t,o){var r=this;r.pageHeader={title:"Sign in to Loc8r"};r.credentials={email:"",password:""};r.returnPage=e.search().page||"/";r.onSubmit=function(){r.formError="";if(!r.credentials.email||!r.credentials.password){r.formError="All fields required, please try again!"}else{r.doLogin()}};r.doLogin=function(){r.formError="formError";t.login(r.credentials).then(function(){e.search("page",null);e.path("vm.returnPage")},function(e){r.formError=e.data.message})};r.loginGoogle=function(){r.disabled=true;o.location=o.location.protocol+"//"+o.location.host+"/api/auth/google"};r.loginFacebook=function(){t.loginFacebook().then(function(e){var t=e;console.log("login with facebook!",t)},function(e){console.log(e)})}};e.$injector=["$location","authentication","$window"];angular.module("loc8rApp").controller("loginCtrl",e)})();"use strict";(function(){var e=function(e,t){var o=this;o.token=t.token;e.loginCallback(o.token)};e.$injector=["authentication","$routeParams"];angular.module("loc8rApp").controller("loginCallbackCtrl",e)})();"use strict";(function(){function e(e,t){var o=this;o.currentPath=e.path();o.isLoggedIn=t.isLoggedIn();o.currentUser=t.currentUser();o.logout=function(){t.logout();e.path("/")}}e.$inject=["$location","authentication"];angular.module("loc8rApp").controller("navigationCtrl",e)})();"use strict";(function(){var e=function(e){var t=this;t.pageHeader={title:"Forgot password Loc8r user"};t.credentials={email:""};t.onSubmit=function(){t.formError="";t.formSuccess="";if(!t.credentials.email){t.formError="All fields required, please try again!"}else{t.sendToEmail()}};t.sendToEmail=function(){t.formError="";t.formSuccess="";e.forgot(t.credentials).then(function(){t.formSuccess="An e-mail has been sent to your mail with further instructions!"},function(e){t.formError=e.data.statusText})}};e.$injector=["authentication"];angular.module("loc8rApp").controller("forgotCtrl",e)})();"use strict";(function(){var e=function(e,t,o,r){var n=this;n.pageHeader={title:"Reset password Loc8r user!"};n.credentials={password:""};n.returnPage="";n.onSubmit=function(){n.formError="";var e=document.getElementById("txtPassword").value;var t=document.getElementById("txtConfirmPassword").value;if(!n.credentials){n.formError="All fields required, please try again"}if(e!==t){n.formError="Passwords do not match"}else{n.doResetpassword(e)}};n.doResetpassword=function(a){n.token=t.token;n.formError="";n.formSuccess="";r.resetpassword(n.token,a).then(function(t){var r=t.data;e(function(){o.path("/login")},5e3);n.time=5e3;var a=function(){if(n.time>1e3){n.time-=1e3;n.formSuccess=r.successMsg+" redirecting to login ("+n.time/1e3+"s )";e(a,1e3)}};e(a,1e3)},function(e){n.formError=e.statusText})}};e.$injector=["$timeout","$routeParams","$location","authentication"];angular.module("loc8rApp").controller("resetpasswordCtrl",e)})();"use strict";(function(){angular.module("loc8rApp").service("loc8rData",e);e.$injector=["$http","authentication"];function e(e,t){var o=function(t,o){return e.get("/api/locations?lng=-0.9690884&lat=51.4550410&maxDistance=20")};var r=function(t){return e.get("/api/locations/"+t)};var n={headers:{Authorization:"Bearer "+t.getToken()}};var a=function(t,o){return e.post("/api/locations/"+t+"/reviews",o,n)};return{locationByCoords:o,locationById:r,addReviewById:a}}})();"use strict";(function(){var e=function(){var e=function(e,t,o){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,t)}else{o()}};return{getPosition:e}};angular.module("loc8rApp").service("geolocation",e)})();"use strict";(function(){function e(e,t,o){delete t.defaults.headers.common["X-Requested-With"];var r=function(t){e.localStorage["loc8r-token"]=t};var n=function(){return e.localStorage["loc8r-token"]};var a=function(e){return t.post("/api/register",e).then(function(e){e=e.data;r(e.token)})};var i=function(e){return t.post("/api/login",e).then(function(e){e=e.data;r(e.token)})};var l=function(e){o.path("/");return r(e)};var c=function(){e.localStorage.removeItem("loc8r-token");e.location.reload()};var s=function(){var t=n();if(t){var o=JSON.parse(e.atob(t.split(".")[1]));return o.exp>Date.now()/1e3}else{return false}};var u=function(){if(s()){var t=n();var o=JSON.parse(e.atob(t.split(".")[1]));console.log(o);return{email:o.email,name:o.name}}};var d=function(e){return t.post("/api/forgot",e).then(function(e){e=e.data})};var m=function(e,o){return t.post("/api/reset/"+e+"/"+o).then(function(e){return e})};return{saveToken:r,getToken:n,register:a,login:i,loginCallback:l,logout:c,isLoggedIn:s,currentUser:u,forgot:d,resetpassword:m}}e.$injector=["$window","$http"];angular.module("loc8rApp").service("authentication",e)})();(function(){var e=function(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"/common/directives/ratingStars/ratingStars.template.html"}};angular.module("loc8rApp").directive("ratingStars",e)})();"use strict";(function(){angular.module("loc8rApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();"use strict";(function(){function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl",controllerAs:"navvm"}}angular.module("loc8rApp").directive("navigation",e)})();"use strict";(function(){function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}angular.module("loc8rApp").directive("pageHeader",e)})();"use strict";(function(){var e=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};var t=function(){var t=function(t){var o,r;if(t&&e(t)){if(t>1){o=parseFloat(t).toFixed(1);r="km"}else{o=parseInt(t*1e3,10);r="m"}return o+" "+r}else{return"?"}};return t};angular.module("loc8rApp").filter("formatDistance",t)})();"use strict";(function(){function e(){return function(e){if(e===undefined){return}var t=e.replace(/\n/g,"<br/>");return t}}angular.module("loc8rApp").filter("addHtmlLineBreaks",e)})();